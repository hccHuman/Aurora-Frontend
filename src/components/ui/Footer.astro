---
/**
 * Footer Component
 *
 * Modern footer with legal information displayed in premium modals.
 * Features improved typography, layout, and visual design.
 *
 * @param {string} lang - The current language code (e.g., "es", "en").
 */
const { lang = "es" } = Astro.props;

import { t } from "@/modules/YOLI/injector";

// IMPORT ESTÁTICO
import TermsES from "../../content/legal/terms.es.md";
import TermsEN from "../../content/legal/terms.en.md";
import PrivacyES from "../../content/legal/privacy.es.md";
import PrivacyEN from "../../content/legal/privacy.en.md";
import CookiesES from "../../content/legal/cookies.es.md";
import CookiesEN from "../../content/legal/cookies.en.md";

// Seleccionamos según idioma
const TermsComponent = lang === "es" ? TermsES : TermsEN;
const PrivacyComponent = lang === "es" ? PrivacyES : PrivacyEN;
const CookiesComponent = lang === "es" ? CookiesES : CookiesEN;

const text = {
  rights: t("footer.rights", lang),
  terms: t("footer.terms", lang),
  privacy: t("footer.privacy", lang),
  cookies: t("footer.cookies", lang),
};
---

<!-- Hidden content for legal documents -->
<div id="legal-content-terms" class="hidden prose prose-invert max-w-none">
  <TermsComponent />
</div>
<div id="legal-content-privacy" class="hidden prose prose-invert max-w-none">
  <PrivacyComponent />
</div>
<div id="legal-content-cookies" class="hidden prose prose-invert max-w-none">
  <CookiesComponent />
</div>

<footer
  class="w-full bg-gradient-to-b from-slate-900 to-slate-950 text-white border-t border-slate-700/50 py-12 mt-16"
>
  <div class="max-w-7xl mx-auto px-6">
    <!-- Main Content -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
      <!-- Brand Section -->
      <div class="flex flex-col gap-4">
        <h3 class="text-xl font-bold text-slate-100">HCC Shop</h3>
        <p class="text-slate-400 text-sm leading-relaxed">
          {t("footer.brand_desc", lang)}
        </p>
      </div>

      <!-- Quick Links -->
      <div class="flex flex-col gap-4">
        <h4 class="text-sm font-semibold uppercase tracking-wider text-slate-400">
          {t("footer.quick_links", lang)}
        </h4>
        <div class="flex flex-col gap-2">
          <a
            href={`/${lang}/products/allproducts`}
            class="text-slate-300 hover:text-red-400 transition-colors text-sm"
          >
            {t("header.products", lang)}
          </a>
          <a
            href={`/${lang}/account/profile`}
            class="text-slate-300 hover:text-red-400 transition-colors text-sm"
          >
            {t("header.profile", lang)}
          </a>
        </div>
      </div>

      <!-- Legal Links -->
      <div class="flex flex-col gap-4">
        <h4 class="text-sm font-semibold uppercase tracking-wider text-slate-400">
          {t("footer.legal", lang)}
        </h4>
        <div class="flex flex-col gap-2">
          <button
            data-modal="terms"
            class="legal-btn text-left text-slate-300 hover:text-red-400 transition-colors text-sm"
          >
            {text.terms}
          </button>
          <button
            data-modal="privacy"
            class="legal-btn text-left text-slate-300 hover:text-red-400 transition-colors text-sm"
          >
            {text.privacy}
          </button>
          <button
            data-modal="cookies"
            class="legal-btn text-left text-slate-300 hover:text-red-400 transition-colors text-sm"
          >
            {text.cookies}
          </button>
        </div>
      </div>
    </div>

    <!-- Divider -->
    <div class="h-px bg-slate-700/50 my-8"></div>

    <!-- Copyright -->
    <div class="text-center">
      <p class="text-slate-400 text-sm">
        © {new Date().getFullYear()} HCC Shop — {text.rights}
      </p>
    </div>
  </div>
</footer>

<!-- Legal Modals (React component) - will be populated by script -->
<div id="legal-modals-root"></div>

<!-- Client-side script for modal handling -->
<script>
  import { createRoot } from "react-dom/client";
  import { createElement } from "react";
  import LegalModalsWrapper from "../tsx/Modal/LegalModalsWrapper";

  document.addEventListener("DOMContentLoaded", () => {
    // Get the HTML content from hidden divs
    const termsContent = document.getElementById("legal-content-terms")?.innerHTML || "";
    const privacyContent = document.getElementById("legal-content-privacy")?.innerHTML || "";
    const cookiesContent = document.getElementById("legal-content-cookies")?.innerHTML || "";

    // Get titles from data attributes or default text
    const termsTitle =
      document.querySelector('[data-modal="terms"]')?.textContent || "Terms & Conditions";
    const privacyTitle =
      document.querySelector('[data-modal="privacy"]')?.textContent || "Privacy Policy";
    const cookiesTitle =
      document.querySelector('[data-modal="cookies"]')?.textContent || "Cookie Policy";

    // Get current language from document
    const currentLang = document.documentElement.lang || "es";

    // Render the React component
    const root = document.getElementById("legal-modals-root");
    if (root) {
      const reactRoot = createRoot(root);
      reactRoot.render(
        createElement(LegalModalsWrapper, {
          termsTitle,
          termsContent,
          privacyTitle,
          privacyContent,
          cookiesTitle,
          cookiesContent,
          lang: currentLang,
        })
      );
    }

    // Attach event listeners to legal buttons
    const buttons = document.querySelectorAll(".legal-btn");
    buttons.forEach((btn) => {
      btn.addEventListener("click", () => {
        const modalType = (btn as any).dataset.modal;
        if (modalType) {
          window.dispatchEvent(
            new CustomEvent("openLegalModal", {
              detail: { type: modalType },
            })
          );
        }
      });
    });
  });
</script>
